<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Detect Community Structures in Networks">
  <meta name="author" content="">
  <title>GraphStream Tutorials</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="bower_components/reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="bower_components/reveal.js/css/theme/none.css" id="theme">
  <link rel="stylesheet" href="css/main.css"/>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'bower_components/reveal.js/css/print/pdf.css' : 'bower_components/reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="bower_components/reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">GraphStream Tutorials</h1>
  <h2 class="author">Detect Community Structures in Networks</h2>
  <h2 class="author"><img style="width:60%;" src="img/zachary.png"/></h2>
  <h3 class="date">Formations JEDI – April 21 2016</h3>
</section>

<section id="outline" class="slide level1">
<h1>Outline</h1>
<!--  {data-background="url('/img/tmp.png')"} -->
<ul>
<li><a href="index.html">General Presentation of GraphStream</a></li>
<li><a href="tutorials.html">First Tutorials</a></li>
<li>Community Structures Tutorial (this presentation)</li>
</ul>
</section>
<section id="community-structure" class="slide level1">
<h1>Community structure</h1>
<p>We will try to detect community structure in networks.</p>
<p><strong>Intuitively</strong>, communities are groups of nodes in a network, where:</p>
<ul>
<li>There are more links between nodes from the same community,</li>
<li>Fewer links between nodes from different communities.</li>
</ul>
<figure>
<img src="img/Community_Structure2.png" alt="Community Structures" /><figcaption>Community Structures</figcaption>
</figure>
</section>
<section id="community-structure-1" class="slide level1">
<h1>Community structure</h1>
<p>Lots of complex networks exhibit community structure.</p>
<ul>
<li>Social networks,</li>
<li>Biological networks,</li>
<li>Information networks,</li>
<li>Road networks,</li>
<li>…</li>
</ul>
<p><img src="img/Network_Community_Structure.svg" alt="CS3" /><img src="img/Community_Structure1.png" alt="CS1" /><img src="img/Community_Structure3.png" alt="CS2" /><img src="img/Community_Structure4.png" alt="CS3" /></p>
<p><strong>Let’s present a method to detect structures and handle network dynamics.</strong></p>
</section>
<section id="agenda" class="slide level1">
<h1>Agenda</h1>
<h3 id="in-this-tutorial-we-will">In this tutorial we will:</h3>
<ul>
<li>Try to detect communities inside a network using various tools provided by GraphStream.</li>
<li>See how to measure the quality of the community structure.</li>
<li>See a technique to approximate communities detection, and adapt to the network dynamics.</li>
</ul>
<p>This is not not an academic, but more a way to show you how to combine the various building blocks of GraphStream to experiment on dynamic networks.</p>
</section>
<section id="determining-community-structure" class="slide level1">
<h1>Determining community structure</h1>
<p>Most often we use two kinds of criteria:</p>
<ul>
<li><strong>Internal validity</strong>: some sort of measure indicates the importance of links inside communities compared to links between communities.</li>
<li><strong>External validity</strong>: we rely on an expert, having a knowledge on the network semantics, to validate the communities.</li>
</ul>
<p>We are focused here in the first one.</p>
</section>
<section id="determining-communities" class="slide level1">
<h1>Determining communities</h1>
<p>Once we have such a measure, several techniques can be used to find the communities:</p>
<ul>
<li><strong>Optimizing the minimum cut</strong>: often used for load balancing. The number of communities is known in advance. One search to minimize the number of edges between communities (the cut).</li>
<li><strong>Hierarchical clustering</strong>: uses a similarity measure to group node pairs, in communities, then to group communities.</li>
<li><strong>Girvan-Newman algorithm</strong>: in this algorithm, we remove progressively edges that lie between communities, using some kind of measure to identify them.</li>
<li><strong>Modularity maximization</strong>: The modularity is one of the most used measures. This methods employ various techniques (often metaheuristics) to compute network divisions and maximize modularity.</li>
</ul>
</section>
<section id="modularity" class="slide level1">
<h1>Modularity</h1>
<p>One of the most used measure is the modularity <span class="math inline">\(Q\)</span>.</p>
<p>Intuition: <span class="math inline">\(Q\)</span> measures the fraction of intra-communities edges minus the same fraction if the network had edges at random (with the same communities divisions). <a href="http://www.pnas.org/content/103/23/8577.full">M. E. J. Newman (2006)</a></p>
<ul>
<li>If <span class="math inline">\(Q=0\)</span> the edges intra-communities is not better than random.</li>
<li>If <span class="math inline">\(Q=1\)</span> we have very strong community structure.</li>
<li>In practice modular network lie between <span class="math inline">\(Q=0.3\)</span> and <span class="math inline">\(Q=0.7\)</span>.</li>
</ul>
<p>Modularity gives results in <span class="math inline">\(\left[-\frac{1}{2} .. 1\right]\)</span>.</p>
</section>
<section id="modularity-1" class="slide level1">
<h1>Modularity</h1>
<p>Suppose a given network with modules:</p>
<p>How to determine its modularity ?</p>
</section>
<section id="modularity-2" class="slide level1">
<h1>Modularity</h1>
<p>
We could compare the proportion of internal links <span style="color:red;">\(I_c\)</span> in each community \(c\) to the number of edges \(m\). Links in green <span style="color:green;">\(O_c\)</span> go out of the community \(c\).
</p>
<p><span class="math inline">\(Q = \sum_c\frac{I_c}{m}~~~~~~~\)</span> <img src="img/Modularity2.svg" alt="Modularirty" /></p>
<p>This would not be sufficient, since putting all nodes in the same community would produce a perfectly modular network !</p>
</section>
<section id="modularity-3" class="slide level1">
<h1>Modularity</h1>
<p>Instead we compare the ratio \(\frac{I_c}{m}\) with the expected value in the same network but with all its links randomly rewired, that is:</p>
<p><span class="math display">\[\frac{(2 I_c + O_c)^2}{(2m)^2}~~~~~~~~\]</span> <img src="img/Modularity3.svg" alt="Modularity" /></p>
<p><span class="math inline">\(Q = \sum_c\frac{I_c}{m} - \sum_c\frac{(2 I_c + O_c)^2}{(2m)^2}\)</span></p>
</section>
<section id="network-dynamics" class="slide level1">
<h1>Network dynamics?</h1>
<ul>
<li>Computing the <strong>modularity</strong> can take some time</li>
<li>But computing the <strong>communities</strong> themselves is the most demanding task.</li>
</ul>
<p>If the network under analysis evolves, it becomes impossible to recompute in <em>real-time</em> the whole modules each time a change occurs in the graph.</p>
</section>
<section id="graph-layouts" class="slide level1">
<h1>Graph layouts</h1>
<p>A novel approach to determine modules uses graph layouts.</p>
<ul>
<li>A layout is a mapping of nodes in a space,</li>
<li>positions are given according to a (aesthetic) criteria.</li>
</ul>
<p>Most layout algorithms are <strong>force based</strong>:</p>
<ul>
<li>repulsive force among all nodes,</li>
<li>attractive force between connected nodes.</li>
</ul>
<p><img src="img/polbooks_fr.png" alt="Layout" /><img src="img/LinLog1.png" alt="LinLog Layout" /></p>
</section>
<section id="the-lin-log-layout" class="slide level1">
<h1>The Lin-Log layout</h1>
<ul>
<li>No aesthetic Layout</li>
<li>Densely connected nodes are grouped at nearby positions.</li>
<li>Weakly connected nodes are separated at distant positions.</li>
</ul>
<p>Most force based algorithms try to the minimize energy.</p>
<p>Lin-Log is based on a <span class="math inline">\((a,r)\)</span>-energy model.</p>
<ul>
<li><span class="math inline">\(a\)</span> is the attraction force factor,</li>
<li><span class="math inline">\(r\)</span> the repulsion force factor.</li>
</ul>
</section>
<section id="the-lin-log-layout-and-network-dynamics" class="slide level1">
<h1>The Lin-Log layout and network dynamics</h1>
<p>After a change in the network the algorithm computes the layout from its <strong>previous equilibrium state</strong>.</p>
<p>Chances are that reusing previous state costs less than a complete re-computation (c.f. re-optimization).</p>
<p>The <strong>Lin-Log</strong> layout was proposed by <a href="http://emis.u-strasbg.fr/journals/JGAA/accepted/2007/Noack2007.11.2.pdf">Andreas Noack (2007)</a>.</p>
</section>
<section id="practical-session" class="slide level1">
<h1>Practical session</h1>
<p>We will see how to:</p>
<ol type="1">
<li>Read, layout and display a graph automatically.</li>
<li>Control the layout directly and change it to a Lin-Log layout.</li>
<li>Retrieve feedback from the distant view process.</li>
<li>Compute communities from the Lin-Log layout and display them.</li>
<li>Retrieve the communities.</li>
<li>Compute the modularity of these communities.</li>
<li>Stress the method on a highly dynamic network.</li>
</ol>
</section>
<section id="how-graphstream-handles-display" class="slide level1">
<h1>How GraphStream handles display</h1>
<p>GraphStream puts the display of the graph in a separate <strong>thread</strong> or <strong>process</strong> or <strong>host</strong>.</p>
<p>Usually the display will evolve in <strong>parallel</strong> of the main application running on the graph.</p>
<figure>
<img src="img/proxy-pipeline.svg" alt="GraphNetwork Viewer" /><figcaption>GraphNetwork Viewer</figcaption>
</figure>
</section>
<section id="how-graphstream-handles-graph-layouts" class="slide level1">
<h1>How GraphStream handles graph layouts</h1>
<p>By default the viewer creates another thread to handle the layout. The default Layout algorithm is a derivative of the Frutcherman-Reingold one.</p>
<figure>
<img src="img/layout-viewer-pipeline.svg" alt="Default Viewer and Layout" /><figcaption>Default Viewer and Layout</figcaption>
</figure>
</section>
<section id="our-pipeline" class="slide level1">
<h1>Our Pipeline</h1>
<figure>
<img src="img/layout-in-graph-pipeline.svg" alt="Self-Maintained-Layout Pipeline" /><figcaption>Self-Maintained-Layout Pipeline</figcaption>
</figure>
</section>
<section id="step-1" class="slide level1">
<h1>Step 1</h1>
<p>Open the <code>modularity</code> package (<code>src/org/graphstream/demo/modularity</code>), then the <code>LinLogLayout.java</code> file.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> LinLogLayout {
  <span class="co">// ...</span>
  <span class="kw">private</span> Graph graph;
  <span class="kw">private</span> Viewer viewer;

  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName)
      <span class="kw">throws</span> IOException, GraphParseException {
    graph = <span class="kw">new</span> <span class="fu">SingleGraph</span>(<span class="st">&quot;communities&quot;</span>);
    viewer = graph.<span class="fu">display</span>(<span class="kw">true</span>);
    graph.<span class="fu">read</span>(fileName);
  }
}</code></pre></div>
<p>It creates a graph, displays, launches an automatic layout on it (the <code>display(true)</code> argument) and then reads it.</p>
</section>
<section id="before-proceeding" class="slide level1">
<h1>Before proceeding</h1>
<p>Before proceeding, to avoid compilation problems copy and paste the following imports to your program, just under the already present imports:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import org.graphstream.algorithm.ConnectedComponents;</span>
<span class="kw">import org.graphstream.algorithm.measure.Modularity;</span>
<span class="kw">import org.graphstream.graph.Edge;</span>
<span class="kw">import org.graphstream.stream.ProxyPipe;</span>
<span class="kw">import org.graphstream.ui.graphicGraph.GraphPosLengthUtils;</span>
<span class="kw">import org.graphstream.ui.graphicGraph.stylesheet.StyleConstants.Units;</span>
<span class="kw">import org.graphstream.ui.layout.springbox.implementations.LinLog;</span>
<span class="kw">import org.graphstream.ui.spriteManager.Sprite;</span>
<span class="kw">import org.graphstream.ui.spriteManager.SpriteManager;</span></code></pre></div>
</section>
<section id="step-2" class="slide level1">
<h1>Step 2</h1>
<ol type="1">
<li>Stop the automatic layout.</li>
<li>Create our own LinLog layout.</li>
<li>Configure it using some <span class="math inline">\(a\)</span> and <span class="math inline">\(r\)</span> parameters.</li>
<li>Connect the layout graph events output to the graph so that the graph nodes receive position attributes.</li>
<li>Connect the graph to the layout so that the layout receive each modification event on the graph.</li>
<li>Run the layout in a loop.</li>
</ol>
</section>
<section class="slide level1">

<h2 id="step-2-1">Step 2</h2>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">private</span> LinLog layout;                  <span class="co">// 2</span>
<span class="kw">private</span> <span class="dt">double</span> a = <span class="dv">0</span>;                   <span class="co">// 3</span>
<span class="kw">private</span> <span class="dt">double</span> r = -<span class="fl">1.3</span>;                <span class="co">// 3</span>
<span class="kw">private</span> <span class="dt">double</span> force = <span class="dv">3</span>;               <span class="co">// 3</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  graph = <span class="kw">new</span> <span class="fu">SingleGraph</span>(<span class="st">&quot;communities&quot;</span>);
  viewer = graph.<span class="fu">display</span>(<span class="kw">false</span>);        <span class="co">// 1</span>
  layout = <span class="kw">new</span> <span class="fu">LinLog</span>(<span class="kw">false</span>);           <span class="co">// 2</span>
  layout.<span class="fu">configure</span>(a, r, <span class="kw">true</span>, force);  <span class="co">// 3</span>
  layout.<span class="fu">addSink</span>(graph);                <span class="co">// 4</span>
  graph.<span class="fu">addSink</span>(layout);                <span class="co">// 5</span>
  graph.<span class="fu">read</span>(fileName);

  <span class="kw">while</span>(<span class="kw">true</span>) {                         <span class="co">// 6</span>
    layout.<span class="fu">compute</span>();                   <span class="co">// 6</span>
  }                                     <span class="co">// 6</span>
}</code></pre></div>
<p>Let’s run it and observe the difference with the former layout.</p>
</section>
<section id="step-3" class="slide level1">
<h1>Step 3</h1>
<p>Problem: The viewer runs in its own thread any interaction with it is not reflected on the graph. Try to grab a node with the mouse and move it… See?</p>
<p>Let’s fix this:</p>
<ol type="1">
<li>Create a back link from the viewer the main process.</li>
<li>Connect this link to our graph in order to receive events.</li>
<li>Proactively check for new events from the viewer.</li>
<li>Check if the user closed the viewer window to properly end the program.</li>
</ol>
</section>
<section class="slide level1">

<figure>
<img src="img/layout-in-graph-2-pipeline.svg" alt="Self-Maintained-Layout Pipeline with Interaction" /><figcaption>Self-Maintained-Layout Pipeline with Interaction</figcaption>
</figure>
</section>
<section class="slide level1">

<h2 id="step-3-1">Step 3</h2>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">private</span> ProxyPipe fromViewer;                          <span class="co">// 1</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  graph = <span class="kw">new</span> <span class="fu">SingleGraph</span>(<span class="st">&quot;communities&quot;</span>);
  viewer = graph.<span class="fu">display</span>(<span class="kw">false</span>);
  fromViewer = viewer.<span class="fu">newThreadProxyOnGraphicGraph</span>();  <span class="co">// 1</span>
  layout = <span class="kw">new</span> <span class="fu">LinLog</span>(<span class="kw">false</span>);

  layout.<span class="fu">configure</span>(a, r, <span class="kw">true</span>, force);
  layout.<span class="fu">addSink</span>(graph);
  graph.<span class="fu">addSink</span>(layout);
  fromViewer.<span class="fu">addSink</span>(graph);                           <span class="co">// 2</span>

  graph.<span class="fu">read</span>(fileName);

  <span class="kw">while</span>(! graph.<span class="fu">hasAttribute</span>(<span class="st">&quot;ui.viewClosed&quot;</span>)) {       <span class="co">// 4</span>
    fromViewer.<span class="fu">pump</span>();                                 <span class="co">// 3</span>
    layout.<span class="fu">compute</span>();
  }
}</code></pre></div>
<p>Now try to grab a node in the display.</p>
</section>
<section class="slide level1">

<h2 id="finding-community-structure-with-a-lin-log-layout">Finding community structure with a Lin-Log layout</h2>
<p><strong>Lin-Log</strong> creates long edges outside communities and short edges between nodes in the same communities.</p>
<p>Let’s use this property to obtain a quick (and hopefully good enough) approximation of the communities.</p>
<ul>
<li>Cut edges that are longer than the global average edge length.</li>
<li>The cut can then be optimised above or under this average to improve the communities.</li>
</ul>
</section>
<section id="step-4" class="slide level1">
<h1>Step 4</h1>
<ol type="1">
<li>Add a stylesheet on the graph.</li>
<li>Enhance the display with anti-aliasing.</li>
<li>Prepare for detection of communities using the layout.</li>
<li>Specify a cut threshold (a factor for the average edge length).</li>
</ol>
</section>
<section id="step-4-1" class="slide level1">
<h1>Step 4</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">private</span> <span class="dt">double</span> cutThreshold = <span class="dv">1</span>;                    <span class="co">// 4</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  <span class="co">// ...</span>
  graph.<span class="fu">addAttribute</span>(<span class="st">&quot;ui.stylesheet&quot;</span>, styleSheet);  <span class="co">// 1</span>
  graph.<span class="fu">addAttribute</span>(<span class="st">&quot;ui.antialias&quot;</span>);               <span class="co">// 2</span>
  graph.<span class="fu">read</span>(fileName);
  <span class="kw">while</span>(! graph.<span class="fu">hasAttribute</span>(<span class="st">&quot;ui.viewClosed&quot;</span>)) {
    fromViewer.<span class="fu">pump</span>();
    layout.<span class="fu">compute</span>();
    <span class="fu">showCommunities</span>();                               <span class="co">// 3</span>
  }
}

<span class="kw">public</span> <span class="dt">void</span> <span class="fu">showCommunities</span>() {                      <span class="co">// 3</span>
  <span class="co">// ...</span>
}

<span class="kw">protected</span> <span class="dt">static</span> String styleSheet =                <span class="co">// 1</span>
    <span class="st">&quot;node { size: 7px; fill-color: rgb(150,150,150); }&quot;</span> +
    <span class="st">&quot;edge { fill-color: rgb(255,50,50); size: 2px; }&quot;</span> +
    <span class="st">&quot;edge.cut { fill-color: rgba(200,200,200,128); }&quot;</span>;</code></pre></div>
</section>
<section id="step-4-a" class="slide level1">
<h1>Step 4 a</h1>
<p>From the stylesheet:</p>
<ul>
<li>Edges are <strong>red</strong>.</li>
<li>Edges with <code>ui.class</code> set to <code>&quot;cut&quot;</code> are <strong>grey</strong>.</li>
</ul>
<p>First part of the <code>showCommunities()</code> method :</p>
<ol type="1">
<li>Browse each edge.</li>
<li>Store each edge’s length.</li>
<li>Compute the average edge length.</li>
</ol>
</section>
<section id="step-4-a-1" class="slide level1">
<h1>Step 4 a</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">void</span> <span class="fu">showCommunities</span>() {
  <span class="dt">int</span> nEdges = graph.<span class="fu">getEdgeCount</span>();
  <span class="dt">double</span> length, averageLength = <span class="dv">0</span>;

  <span class="kw">for</span>(Edge edge : graph.<span class="fu">getEachEdge</span>()) {              <span class="co">// 1</span>
    length  = GraphPosLengthUtils.<span class="fu">edgeLength</span>(edge);
    edge.<span class="fu">setAttribute</span>(<span class="st">&quot;length&quot;</span>, length);               <span class="co">// 2</span>
    averageLength += length;                          <span class="co">// 3</span>
  }
  averageLength /= nEdges;                            <span class="co">// 3</span>

  <span class="co">// ...</span>
}</code></pre></div>
</section>
<section id="step-4-b" class="slide level1">
<h1>Step 4 b</h1>
<p>Second part of the <code>showCommunities()</code> method: select which edge is inter-community.</p>
<ol type="1">
<li>Browse anew each edge.</li>
<li>Compare their length with the <strong>average</strong> length.</li>
<li><ol type="a">
<li>If they are longer, mark them with a <code>&quot;cut&quot;</code> attribute.</li>
<li>Else, remove the “cut” attribute.</li>
</ol></li>
</ol>
</section>
<section id="step-4-b-1" class="slide level1">
<h1>Step 4 b</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="dt">void</span> <span class="fu">showCommunities</span>() {
  <span class="co">// ...</span>
  <span class="kw">for</span>(Edge edge : graph.<span class="fu">getEachEdge</span>()) {           <span class="co">// 1</span>
    length  = edge.<span class="fu">getNumber</span>(<span class="st">&quot;length&quot;</span>);
    <span class="kw">if</span>(length &gt; averageLength * cutThreshold) {    <span class="co">// 2</span>
      edge.<span class="fu">addAttribute</span>(<span class="st">&quot;ui.class&quot;</span>, <span class="st">&quot;cut&quot;</span>);        <span class="co">// 3.1</span>
      edge.<span class="fu">addAttribute</span>(<span class="st">&quot;cut&quot;</span>);
    } <span class="kw">else</span> {
      edge.<span class="fu">removeAttribute</span>(<span class="st">&quot;ui.class&quot;</span>);            <span class="co">// 3.2</span>
      edge.<span class="fu">removeAttribute</span>(<span class="st">&quot;cut&quot;</span>);
    }
  }
}</code></pre></div>
</section>
<section id="the-zachary-karate-club" class="slide level1">
<h1>The Zachary Karate Club</h1>
<p>The graph we use as a demo comes from a well known social study in a Karate Club.</p>
<p>Nodes represent members and edges their friendship ties.</p>
<p>At a given time one of the member left the club to create its own club. Some members stayed in the old one, while others quit to join the new one.</p>
<p>This graph usually admits at least two communities (the two clubs), although smaller sub-communities can be observed.</p>
</section>
<section id="computing-the-number-of-communities" class="slide level1">
<h1>Computing the number of communities</h1>
<p>GraphStream contains a algorithm that <strong>compute</strong> and <strong>update</strong> the number of <strong>connected components</strong> of a graph.</p>
<p>This algorithm can ignore edges with a specific attribute (say <code>&quot;cut&quot;</code>).</p>
<p><strong>Sprites</strong> in the viewer help visual the number of communities.</p>
</section>
<section id="step-5-a" class="slide level1">
<h1>Step 5 a</h1>
<p>Compute the number of connected components</p>
<ol type="1">
<li>Add a connected component algorithm.</li>
<li>Initialize it on the graph.</li>
<li>Setup a cut attribute so that the algorithm ignore the long edges.</li>
</ol>
</section>
<section id="step-5-a-1" class="slide level1">
<h1>Step 5 a</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="co">// ...</span>
<span class="kw">private</span> ConnectedComponents cc;                           <span class="co">// 1</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  graph = <span class="kw">new</span> <span class="fu">SingleGraph</span>(<span class="st">&quot;communities&quot;</span>);
  viewer = graph.<span class="fu">display</span>(<span class="kw">false</span>);
  fromViewer = viewer.<span class="fu">newThreadProxyOnGraphicGraph</span>();
  layout = <span class="kw">new</span> <span class="fu">LinLog</span>(<span class="kw">false</span>);
  cc = <span class="kw">new</span> <span class="fu">ConnectedComponents</span>(graph);                    <span class="co">// 2</span>

  layout.<span class="fu">configure</span>(a, r, <span class="kw">true</span>, force);
  cc.<span class="fu">setCutAttribute</span>(<span class="st">&quot;cut&quot;</span>);                              <span class="co">// 3</span>
  <span class="co">// ...</span>
}
<span class="co">// ...</span></code></pre></div>
</section>
<section id="step-5-b" class="slide level1">
<h1>Step 5 b</h1>
<p>Display the number of connected components using a sprite:</p>
<ol type="1">
<li>Create a sprite that will indicate the connected component count.</li>
<li>Position this sprite.</li>
<li>Update it regularly with the number of components.</li>
<li>Update the style sheet to display the sprite correctly.</li>
</ol>
</section>
<section id="step-5-b-1" class="slide level1">
<h1>Step 5 b</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="co">// ...</span>
<span class="kw">private</span> SpriteManager sm;                                  <span class="co">// 1</span>
<span class="kw">private</span> Sprite ccCount;                                    <span class="co">// 1</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  <span class="co">// ...</span>
  cc = <span class="kw">new</span> <span class="fu">ConnectedComponents</span>(graph);
  sm = <span class="kw">new</span> <span class="fu">SpriteManager</span>(graph);                           <span class="co">// 1</span>
  ccCount = sm.<span class="fu">addSprite</span>(<span class="st">&quot;CC&quot;</span>);                            <span class="co">// 1</span>
  <span class="co">// ...</span>
  cc.<span class="fu">setCutAttribute</span>(<span class="st">&quot;cut&quot;</span>);
  ccCount.<span class="fu">setPosition</span>(Units.<span class="fu">PX</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">0</span>);                <span class="co">// 2</span>
  <span class="co">// ...</span>
  <span class="kw">while</span>(! graph.<span class="fu">hasAttribute</span>(<span class="st">&quot;ui.viewClosed&quot;</span>)) {
    <span class="co">//...</span>
    <span class="fu">showCommunities</span>();
    ccCount.<span class="fu">setAttribute</span>(<span class="st">&quot;ui.label&quot;</span>,                       <span class="co">// 3</span>
      String<span class="fu">.format</span>(<span class="st">&quot;Modules </span><span class="ch">%d</span><span class="st">&quot;</span>, cc.<span class="fu">getConnectedComponentsCount</span>()));
  }
}
<span class="co">// ...</span>
<span class="kw">protected</span> <span class="dt">static</span> String styleSheet =                       <span class="co">// 4</span>
    <span class="st">&quot;node { size: 7px; fill-color: rgb(150,150,150); }&quot;</span> +
    <span class="st">&quot;edge { fill-color: rgb(255,50,50); size: 2px; }&quot;</span> +
    <span class="st">&quot;edge.cut { fill-color: rgba(200,200,200,128); }&quot;</span> +
    <span class="st">&quot;sprite#CC { size: 0px; text-color: rgb(150,100,100); text-size: 20; }&quot;</span>;</code></pre></div>
</section>
<section id="computing-the-modularity" class="slide level1">
<h1>Computing the modularity</h1>
<p>Now that communities are identified, we can measure the quality of the partition.</p>
<p>GraphStream has a <strong>modularity</strong> algorithm that follows each update on the graph.</p>
<ul>
<li>The <strong>modularity</strong> algorithm needs that each node contains an attribute indicating its community.</li>
<li>The <strong>connected components</strong> algorithm can identify each component.</li>
</ul>
</section>
<section id="step-6-a" class="slide level1">
<h1>Step 6 a</h1>
<ol type="1">
<li>Add the modularity algorithm.</li>
<li>Create it so that it uses the <code>&quot;module&quot;</code> attribute on nodes.</li>
<li>Initialise it on the graph.</li>
<li>Have the connected components algorithm tag components/communities with a <code>&quot;module&quot;</code> attribute.</li>
</ol>
</section>
<section id="step-6-a-1" class="slide level1">
<h1>Step 6 a</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="co">// ...</span>
<span class="kw">private</span> Modularity modularity;                            <span class="co">// 1</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  cc = <span class="kw">new</span> <span class="fu">ConnectedComponents</span>(graph);
  sm = <span class="kw">new</span> <span class="fu">SpriteManager</span>(graph);
  ccCount = sm.<span class="fu">addSprite</span>(<span class="st">&quot;CC&quot;</span>);
  modularity = <span class="kw">new</span> <span class="fu">Modularity</span>(<span class="st">&quot;module&quot;</span>);                  <span class="co">// 2</span>

  modularity.<span class="fu">init</span>(graph);                                 <span class="co">// 3</span>
  layout.<span class="fu">configure</span>(a, r, <span class="kw">true</span>, force);
  cc.<span class="fu">setCutAttribute</span>(<span class="st">&quot;cut&quot;</span>);
  ccCount.<span class="fu">setPosition</span>(Units.<span class="fu">PX</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">0</span>);
  cc.<span class="fu">setCountAttribute</span>(<span class="st">&quot;module&quot;</span>);                         <span class="co">// 4</span>
  <span class="co">// ...</span>
}</code></pre></div>
</section>
<section id="step-6-b" class="slide level1">
<h1>Step 6 b</h1>
<p>Display the modularity value using a sprite:</p>
<ol type="1">
<li>Add a sprite for the modularity.</li>
<li>Position it.</li>
<li>Update it regularly with the modularity value.</li>
<li>Update the style sheet for this other sprite.</li>
</ol>
</section>
<section id="step-6-b-1" class="slide level1">
<h1>Step 6 b</h1>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="co">// ...</span>
<span class="kw">private</span> Sprite ccCount, modValue;                            <span class="co">// 1</span>
<span class="kw">public</span> <span class="dt">void</span> <span class="fu">findCommunities</span>(String fileName) <span class="kw">throws</span> <span class="kw">... </span>{
  <span class="co">// ...</span>
  modularity = <span class="kw">new</span> <span class="fu">Modularity</span>(<span class="st">&quot;module&quot;</span>);
  modValue = sm.<span class="fu">addSprite</span>(<span class="st">&quot;M&quot;</span>);                              <span class="co">// 1</span>
  <span class="co">// ...</span>
  cc.<span class="fu">setCutAttribute</span>(<span class="st">&quot;cut&quot;</span>);
  ccCount.<span class="fu">setPosition</span>(Units.<span class="fu">PX</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">0</span>);
  cc.<span class="fu">setCountAttribute</span>(<span class="st">&quot;module&quot;</span>);
  modValue.<span class="fu">setPosition</span>(Units.<span class="fu">PX</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">0</span>);                 <span class="co">// 2</span>
  <span class="co">// ...</span>
  <span class="kw">while</span>(! graph.<span class="fu">hasAttribute</span>(<span class="st">&quot;ui.viewClosed&quot;</span>)) {
    <span class="co">//...</span>
    ccCount.<span class="fu">setAttribute</span>(<span class="st">&quot;ui.label&quot;</span>,
      String<span class="fu">.format</span>(<span class="st">&quot;Modules </span><span class="ch">%d</span><span class="st">&quot;</span>, cc.<span class="fu">getConnectedComponentsCount</span>()));
    modValue.<span class="fu">setAttribute</span>(<span class="st">&quot;ui.label&quot;</span>,                        <span class="co">// 3</span>
      String<span class="fu">.format</span>(<span class="st">&quot;Modularity </span><span class="ch">%f</span><span class="st">&quot;</span>, modularity.<span class="fu">getMeasure</span>()));
  }
}

<span class="kw">protected</span> <span class="dt">static</span> String styleSheet =
    <span class="co">// ...                                                   // 4</span>
    <span class="st">&quot;sprite#CC { size: 0px; text-color: rgb(150,100,100); text-size: 20; }&quot;</span> +
    <span class="st">&quot;sprite#M  { size: 0px; text-color: rgb(100,150,100); text-size: 20; }&quot;</span>;</code></pre></div>
</section>
<section id="thats-it" class="slide level1">
<h1>That’s it!</h1>
<p>Some other graphs are provided in the <code>data</code> directory of the eclipse project.</p>
<p>You can experiment on them, and play with the <code>cutThreshold</code> parameter as well as the <span class="math inline">\((a, r)\)</span> and <code>force</code> parameters. Here is a set of good values for these graphs:</p>
<table>
<thead>
<tr class="header">
<th>Graph</th>
<th>a</th>
<th>r</th>
<th>force</th>
<th>cutThreshold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>karate.gml</td>
<td>0</td>
<td>-1.3</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="even">
<td>dolphins.gml</td>
<td>0</td>
<td>-1.2</td>
<td>8</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td>polbooks.gml</td>
<td>0</td>
<td>-1.9</td>
<td>5</td>
<td>0.8</td>
</tr>
</tbody>
</table>
</section>
<section id="what-about-a-dynamic-graph" class="slide level1" data-background="url(/img/boids.png)">
<h1>What about a dynamic graph</h1>
<p>Let’s try the method on a really dynamic graph.</p>
<p>Consider a <a href="http://www.red3d.com/cwr/boids/">Boids</a> Simulation.</p>
<p>The <code>LinLogLayoutAndBoids.java</code> file in the <code>modularity</code> package contains a working example of LinLog analysis of a Boids simulation.</p>
</section>
    </div>
  </div>

  <script src="bower_components/reveal.js/lib/js/head.min.js"></script>
  <script src="bower_components/reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: 0,
        // Display a presentation progress bar
        progress: 0,
        // Display the page number of the current slide
        slideNumber: 1,
        // Enable keyboard shortcuts for navigation
        keyboard: true,
        // Enable the slide overview mode
        overview: true,
        // Vertical centering of slides
        center: 1,
        // Enables touch navigation on devices with touch input
        touch: true,
        // Loop the presentation
        loop: true,
        // Hides the address bar on mobile devices
        hideAddressBar: true,
        // Transition style
        transition: 'linear', // none/fade/slide/convex/concave/zoom
        // Transition speed
        transitionSpeed: 'fast', // default/fast/slow
        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,
        height: 800,
        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // Optional reveal.js plugins
        dependencies: [
          { src: 'bower_components/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'bower_components/reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'bower_components/reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
